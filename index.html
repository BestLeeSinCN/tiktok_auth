<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>TikTok Auth Redirect</title>
</head>
<body>
<script>
window.initTikTokLogin = function(params) {
  const p = params;

  const search = new URLSearchParams(window.location.search);
  const code = search.get("code");
  const state = search.get("state");

  // 回调给 App
  if (code) {
    if (window.TikTokLoginChannel && window.TikTokLoginChannel.postMessage) {
      window.TikTokLoginChannel.postMessage(JSON.stringify({
        code: code,
        state: state
      }));
      return;
    }

    // H5 模式（可替换为你的页面逻辑）
    document.body.innerText = "Code: " + code;
    return;
  }

  // 否则跳转 TikTok 授权
  const url =
    "https://www.tiktok.com/v2/auth/authorize/?" +
    "client_key=" + encodeURIComponent(p.clientKey) +
    "&response_type=code" +
    "&scope=" + encodeURIComponent(p.scope) +
    "&redirect_uri=" + encodeURIComponent(p.redirectUri) +
    "&state=" + encodeURIComponent(p.state);

  window.location.href = url;
};
</script>

跳转中...
</body>
</html>
